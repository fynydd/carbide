@inherits Umbraco.Web.Mvc.UmbracoViewPage
@using Fynydd.Carbide
@using Carbide.Web.Helpers
@{
    Layout = "Master.cshtml";

    var home = Model.AncestorOrSelf(1);
    var settings = home.Children.First(c => c.ContentType.Alias == "settings");
    var primaryNavigation = settings.SafeNestedValues("navigation").Where(n => n.SafeValue<bool>("enabled") && n.SafeValue("position") == "Primary").FirstOrDefault();
    var footerNavigation = settings.SafeNestedValues("navigation").Where(n => n.SafeValue<bool>("enabled") && n.SafeValue("position") == "Footer").FirstOrDefault();
}
@section pageCssSection
{
    @{
        // Page-level CSS overrides
        Html.ViewData.Add(new KeyValuePair<string, object>("cssSelector", ":root"));
        Html.RenderPartial("_Partial_CSS_Custom_Properties", Model.PickerValue("style"), Html.ViewData);
        Html.ViewData.Clear();
    }
}
@{
    if (primaryNavigation != null)
    {
        Html.ViewData.Add(new KeyValuePair<string, object>("instanceId", "primary-navigation"));
        Html.RenderPartial("_Partial_" + primaryNavigation.SafeValue("navigationStyle") + "_Primary_Navigation_Unit", primaryNavigation, Html.ViewData);
        Html.ViewData.Clear();
    }

    Html.RenderPartial("_Partial_Render_Content_Units");

    if (footerNavigation != null)
    {
        Html.ViewData.Add(new KeyValuePair<string, object>("instanceId", "footer-navigation"));
        Html.RenderPartial("_Partial_" + footerNavigation.SafeValue("navigationStyle") + "_Footer_Navigation_Unit", footerNavigation, Html.ViewData);
        Html.ViewData.Clear();
    }
}
